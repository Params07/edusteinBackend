"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[637,376,638,597,956,523,718],{17376:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var s=a(65043),l=a(86213),n=a(23894);const o=e=>{const[t,a]=(0,s.useState)(!1);return{downloadExcelFile:async t=>{try{a(!0);const s=await l.A.post("/createExcel",t,{responseType:"blob"}),n=window.URL.createObjectURL(new Blob([s.data])),o=document.createElement("a");o.href=n,o.setAttribute("download",e+".xlsx"),document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(n),a(!1)}catch(s){a(!1),(0,n.y)({success:!1,message:"Error in downloading file"}),console.error("Error downloading file:",s)}},downloading:t}}},80638:(e,t,a)=>{a.r(t),a.d(t,{default:()=>l});a(65043);var s=a(70579);const l=e=>{let{data:t,component:a,action:l}=e;if(!t||0===t.length)return(0,s.jsx)("p",{children:"No data available"});const n=["Action",...Object.keys(t[0])];return(0,s.jsx)("div",{className:"overflow-x-auto m-4",children:(0,s.jsx)("div",{className:"overflow-y-auto h-[500px] no-scrollbar",children:(0,s.jsxs)("table",{className:"min-w-full border border-collapse border-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-100 border-b w-full sticky top-0 z-5 h-16",children:(0,s.jsx)("tr",{children:n.map((e=>(0,s.jsx)("th",{className:"py-2 px-4 border-b text-center bg-gray-100",children:"Action"===e?l:e},e)))})}),(0,s.jsx)("tbody",{children:t.map(((e,t)=>(0,s.jsx)("tr",{className:"py-2 px-4 border-b text-center",children:n.map((t=>"Action"===t?(0,s.jsx)("td",{className:"py-2 px-4 border-b text-center",children:a(e)},t):(0,s.jsx)("td",{className:"py-2 px-4 border-b text-center",children:e[t]},t)))},t)))})]})})})}},87597:(e,t,a)=>{a.r(t),a.d(t,{default:()=>r});var s=a(65043),l=a(92823),n=a.n(l),o=(a(25884),a(67718)),d=a(70579);const r=e=>{let{emails:t,onClose:a,showPopup:l}=e;const[r,c]=(0,s.useState)(""),[i,u]=(0,s.useState)(""),[m,p]=(0,s.useState)([]),[h,b]=(0,s.useState)(!1),[x,f]=(0,s.useState)({}),{post:g,loading:j,error:y}=(0,o.default)("/send-email"),[w,v]=(0,s.useState)("now"),N=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}T${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`,[S,C]=(0,s.useState)(N(new Date));return(0,d.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-75 flex justify-center items-center",children:(0,d.jsxs)("div",{className:"bg-white w-11/12 md:w-2/3 lg:w-1/2 p-4 rounded-lg",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,d.jsx)("h2",{className:"text-lg font-bold",children:"Draft Email"}),(0,d.jsx)("button",{onClick:a,className:"text-xl font-bold",children:"\xd7"})]}),(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsx)("label",{className:"block text-sm font-bold mb-2",children:"To:"}),(0,d.jsx)("div",{className:"border p-2 rounded",children:t.join(", ")})]}),(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsx)("label",{className:"block text-sm font-bold mb-2",children:"Subject:"}),(0,d.jsx)("input",{type:"text",value:r,required:!0,onChange:e=>c(e.target.value),className:"w-full border border-gray-300 p-2 rounded"})]}),(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsx)("label",{className:"block text-sm font-bold mb-2",children:"Body:"}),(0,d.jsx)(n(),{value:i,onChange:u}),x.content&&(0,d.jsxs)("p",{className:"text-red-300",children:[" ",x.content]})]}),(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsx)("label",{className:"block text-sm font-bold mb-2",children:"Attach Files:"}),(0,d.jsx)("input",{type:"file",multiple:!0,onChange:e=>{p(Array.from(e.target.files))},className:"w-full border border-gray-300 p-2 rounded"}),m.length>0&&(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:"font-semibold mt-2",children:"Selected Files:"}),(0,d.jsx)("ul",{children:m.map(((e,t)=>(0,d.jsx)("li",{children:e.name},t)))})]})]}),(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsx)("label",{className:"block text-sm font-bold mb-2",children:"Schedule Email:"}),(0,d.jsxs)("select",{value:w,onChange:e=>v(e.target.value),className:"w-full border border-gray-300 p-2 rounded",children:[(0,d.jsx)("option",{value:"now",children:"Send Now"}),(0,d.jsx)("option",{value:"schedule",children:"Schedule for Later"})]}),"schedule"===w&&(0,d.jsxs)("div",{className:"mt-2",children:[(0,d.jsx)("label",{className:"block text-sm font-bold mb-2",children:"Schedule Date & Time:"}),(0,d.jsx)("input",{type:"datetime-local",min:N(new Date),value:S,onChange:e=>C(e.target.value),className:"w-full border border-gray-300 p-2 rounded"})]})]}),(0,d.jsxs)("div",{className:"flex justify-end mt-4",children:[(0,d.jsx)("button",{onClick:a,className:"bg-red-500 text-white px-4 py-2 rounded mr-2",children:"Cancel"}),(0,d.jsx)("button",{onClick:async()=>{const e={};if(!i)return e.content="cant send empty email",void f(e);f(e),b(!0);const s=new FormData;if(s.append("subject",r),s.append("message",i),s.append("to",JSON.stringify(t)),m.forEach((e=>{s.append("files",e)})),"schedule"===w){const e=new Date,t=new Date(S),a=198e5,l=(new Date(t.getTime()-a),t.getTime()-e.getTime());s.append("startDelay",l),console.log(l)}else s.append("startDelay",0);try{await g(s),l({success:!0,message:"email sent"}),a()}catch(y){console.error("Failed to send emails:",y),l({success:!1,message:"Couldnt send email"})}finally{b(!1)}},className:"bg-blue-500 text-white px-4 py-2 rounded "+(j||h?"opacity-50 cursor-not-allowed":""),disabled:j||h,children:j||h?"Sending...":"Send"})]}),y&&(0,d.jsxs)("p",{className:"text-red-500 mt-2",children:["Error: ",y.message]})]})})}},6956:(e,t,a)=>{a.r(t),a.d(t,{default:()=>n});var s=a(65043),l=a(90523);const n=e=>{let{bootcampId:t}=e;const[a,n]=(0,s.useState)([]),[o,d]=(0,s.useState)(!1),r=0!==t?`/registrations/registrations?bootcampId=${t}`:null,{fetchData:c,data:i,loading:u,error:m}=(0,l.default)(r);return(0,s.useEffect)((()=>{d(0!==t)}),[t]),(0,s.useEffect)((()=>{o&&c()}),[o,c]),(0,s.useEffect)((()=>{i&&n(i)}),[i]),a}},90523:(e,t,a)=>{a.r(t),a.d(t,{default:()=>n});var s=a(65043),l=a(86213);const n=e=>{const[t,a]=(0,s.useState)(!1),[n,o]=(0,s.useState)([]),[d,r]=(0,s.useState)(null),c=(0,s.useCallback)((async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e){a(!0),r(null);try{const a=await l.A.get(e,{params:t,withCredentials:!0});o(a.data)}catch(s){r(s)}finally{a(!1)}}}),[e]);return(0,s.useEffect)((()=>{e&&c()}),[c]),{fetchData:c,data:n,loading:t,error:d}}},67718:(e,t,a)=>{a.r(t),a.d(t,{default:()=>n});var s=a(65043),l=a(86213);const n=e=>{const[t,a]=(0,s.useState)(!1),[n,o]=(0,s.useState)(null);return{post:async t=>{a(!0),o(null);try{const s=t instanceof FormData;console.log(s);const n=await l.A.post(e,t,{withCredentials:!0,headers:s?{"Content-Type":"multipart/form-data"}:{"Content-Type":"application/json"}});return a(!1),n.data}catch(s){throw o(s),a(!1),s}},loading:t,error:n}}},53637:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});var s=a(65043),l=a(81278),n=a(87597),o=a(23894),d=a(6956),r=a(80638),c=a(90523),i=a(17376),u=a(70579);const m=()=>{const[e,t]=(0,s.useState)([]),[a,m]=(0,s.useState)(null),[p,h]=(0,s.useState)([]),[b,x]=(0,s.useState)(!1),[f,g]=(0,s.useState)([]),[j,y]=(0,s.useState)(!1),{downloadExcelFile:w,downloading:v}=(0,i.default)("registration_data"),{data:N=[],fetchData:S}=(0,c.default)("/bootcamps/bootcamp?id=0");(0,s.useEffect)((()=>{if(N){const e=N.map((e=>({label:e.title,value:e.id})));t(e),!a&&e.length>0&&m(e[0])}}),[N]);const C=(0,d.default)({bootcampId:a?a.value:0});(0,s.useEffect)((()=>{if(b&&C){const e=C.map((e=>e.id));h(e)}else h([])}),[b,C]);return(0,u.jsxs)("div",{className:"w-full",children:[(0,u.jsxs)("div",{className:"w-full flex items-center justify-between shadow-md py-6 px-4 h-24 mb-6",children:[(0,u.jsx)("p",{className:"text-xl font-bold",children:"Registrations Data"}),(0,u.jsx)(l.Ay,{className:"w-64",name:"bootcamp",value:a,options:e,required:!0,placeholder:"Bootcamp Name",onChange:e=>m(e)}),(0,u.jsx)("input",{tabIndex:-1,autoComplete:"off",style:{opacity:0,height:0,position:"absolute"},value:a?a.value:"",onChange:()=>{},required:!0})]}),(0,u.jsx)("div",{className:"pl-5 pb-3",children:0!==p.length&&(0,u.jsxs)("div",{className:"flex space-x-4",children:[(0,u.jsx)("button",{className:"bg-black px-5 py-2 text-white rounded-md",onClick:()=>{(()=>{const e=C.filter((e=>p.includes(e.id))).map((e=>e.email));g(e),y(!0)})()},children:"Send Mail"}),(0,u.jsx)("button",{disabled:v,className:"bg-black px-5 py-2 text-white rounded-md",onClick:()=>{(async()=>{const e=C.filter((e=>p.includes(e.id))).map((e=>e));w(e)})()},children:v?"Downloading":"Download"})]})}),C&&(0,u.jsx)(r.default,{data:C,component:e=>(0,u.jsx)("input",{type:"checkbox",checked:p.includes(e.id),onChange:()=>{return t=e.id,void h((e=>e.includes(t)?e.filter((e=>e!==t)):[...e,t]));var t}}),action:(0,u.jsx)("input",{type:"checkbox",checked:b,onChange:()=>{x((e=>!e))}})}),j&&(0,u.jsx)(n.default,{emails:f,onClose:()=>y(!1),showPopup:o.y})]})}}}]);
//# sourceMappingURL=637.48151b8c.chunk.js.map